{"name":"Sendtsudamagmobitomykindle","tagline":"AppleScript for Mail.app to download .mobi file for the incoming TsudaMag from Yakan-hiko's web site automatically.","body":"# 概要\r\nsendTsudaMagmobiToMyKindleは、Macの標準メールクライアント「メール(Mail.app)」用のルールで使用するAppleScriptです。\r\n\r\n# 目的\r\nメディアアクティビスト／ジャーナリストである[津田大介氏](http://tsuda.ru)のメールマガジン[『津田大介の「メディアの現場」』](http://tsuda.ru/category/tsudamag/)は、[まぐまぐ](http://www.mag2.com/m/0001334191.html?utm_source=tsuda.ru&utm_medium=サンプル記事&utm_campaign=tsuda.ru)、[夜間飛行](http://yakan-hiko.com/tsuda.html?utm_source=tsuda.ru&utm_medium=サンプル記事&utm_campaign=tsuda.ru)等のメールマガジンプロバイダで配信されています。\r\n\r\n中でも、[夜間飛行](http://yakan-hiko.com/tsuda.html?utm_source=tsuda.ru&utm_medium=サンプル記事&utm_campaign=tsuda.ru)での配信は、通常のPlain Textのメールで配信されるほか、サイトからはepubやmobiのファイルをダウンロードでき、電子書籍端末で快適に読むことができるのでガジェヲタまっしぐら、という感じで素敵です。\r\n\r\nただ、epubやmobiをダウンロードするには、メール着弾後、メール内に書いてあるURLにアクセスし、IDとパスワードでログインする必要があり、また、ダウンロードした後にもファイルを電子書籍端末に転送する必要があります。手動で！ めんどくさい！ 耐えられない！\r\n\r\nというわけで、自動化スクリプトをその面倒くさい手動手順以上の手間をかけて作ってみました。\r\n\r\n割と限定された環境で動作するので、そのまま恩恵を得られる人はそんなに多くはないかも。\r\n\r\n# 動作環境\r\n## ローカルな環境\r\n\r\n* Mac OS X 10.8 (で確認したという話で、それ以前でも使えるとは思います)\r\n* メール(Mail.app) 6.5 (で確認したと言う話で、それ以前でも使えるとは思いますが、[6.2あたりだとフィルタでAppleScriptが動かないという噂](http://piyocast.com/as/archives/category/application_control/mailapp/)もあるようです。正直、このあたりの事情はサポートできません) \r\n* AppleScript エディタ 2.5.1 (で確認したry\r\n\r\n## メルマガ購読環境\r\n\r\n* 夜間飛行\r\n * 津田マガを購読している必要があります (つか読んでない人は必要ないでしょ)\r\n* Kindle PaperWhite/Fire等、mobiファイルを読める電子書籍端末\r\n * Kindleにファイルを送り付けるmail addressは必須です。 \r\n\r\n#インストール方法\r\n## AppleScriptファイルのダウンロードと配置\r\n1. githubのこのページから、sendTsudaMagmobiToMyKindle.scpt をダウンロードします。\r\n1. sendTsudaMagmobiToMyKindle.scpt をホームディレクトリの Library/Application Scripts/com.apple.mail フォルダにコピーします。\r\n * ライブラリ(Library)フォルダは普通表示されないのですが、optionキーを押しながらFinderの「移動」メニューを開くと開くことができます。\r\n * Application Scripts フォルダ、com.apple.mail フォルダが存在しない場合は、新規フォルダで作成してください。\r\n\r\n## AppleScriptファイルの編集\r\n個々人でお持ちのアカウントにあわせて、スクリプトの内容を少し修正する必要があります。\r\n\r\n1. sendTsudaMagmobiToMyKindle.scpt をダブルクリックします。\r\n　→AppleScript エディタが開きます。\r\n1. 1行目、「property yakanID :」の後ろに、ダブルクォートで囲んで、夜間飛行のユーザIDを記入します。\r\n`property yakanID : \"yakan\"`\r\n1. 2行目、「property yakanPass :」の後ろに、ダブルクォートで囲んで、夜間飛行のパスワードを記入します。\r\n`property yakanPass : \"123456\"`\r\n1. 3行目、「property kindleMailAddress :」の後ろに、ダブルクォートで囲んで、Kindleデバイスへの送信アドレスを記入します。\r\n`property kindleMailAddress : \"hogefuga_99@kindle.com\"`\r\n1. 「ファイル」→「保存」で保存します。\r\n1. AppleScript エディタを終了します。\r\n\r\n## メール(Mail.app)の設定\r\n1. メールの「環境設定...」を開きます。\r\n　→環境設定ダイアログが開きます。\r\n1. 「ルール」タブを開きます。\r\n　→環境設定ダイアログの内容が「ルール」の一覧表示になります。\r\n1. 「ルールを追加」ボタンをクリックします。\r\n　シートが表示され、追加するルールの内容の設定を行えるようになります。\r\n1. 「説明：」には「津田マガ自動処理」等を入力します。\r\n1. 「以下の **すべての** 条件に一致した場合」を選び、「件名」として『 **津田大介の「メディアの現場」** 』を含む、「差出人」として『 **not_reply@yakan-hiko.com** 』を含む、を指定します。\r\n1. 「以下の操作を実行：」に対して、『 **AppleScriptを実行** 』で、『 **sendTsudaMagmobiToMyKindle.scpt** 』を選びます。また、「＋」をクリックして『 **ルールの評価を停止** 』も追加しておきましょう。\r\n1. 以上の設定ができたら「OK」をクリックしてルールの設定完了です。\r\n1. この「津田マガ自動処理」ルールは、できればリストの先頭近辺に置いて、他のルールと干渉しないようにしてください。\r\n * このルールの対象となる津田マガメールは、他のルール、およびこのルール自身でも、フォルダを移動しないほうがいいみたいです。AppleScriptが処理すべきメールを見失ってしまって、処理ができないケースがある感じです。\r\n1. 環境設定ダイアログを閉じて設定終了です。\r\n\r\n# 動作の実際\r\n本スクリプトをインストールし、ルールを設定したメールを起動しておいて、定期的にメールを受信するようにしておくと、津田マガが届いた時に自動的に以下の動作を行います。\r\n\r\n1. メール着弾\r\n1. 水面下で：メール内容の解析とmobiファイルのURLの取り出し\r\n1. 水面下で：mobiファイルをダウンロードする夜間飛行サイトにアクセス\r\n1. 水面下で：夜間飛行サイトへのログイン\r\n1. 水面下で：mobiファイルのダウンロード\r\n1. mobiファイルを添付ファイルとする、Kindleへの転送メールを作成\r\n\r\n水面下でやってるところは特に処理は見えないので、人間の目からはメール着弾後、しばらくすると勝手にメールが作成され、その中に添付ファイルが入る、という感じに見えます。\r\n\r\n安全のため、作成したメールは自動的に送信までは行わず、下書きの状態で画面に留まります。手動で送信してください。しばらくするとお手持ちのKindleで電子書籍のかたちで津田マガが読めるようになるはずです。\r\n\r\nこれでうまくいくことが確認できたら、スクリプトを少しいじることで、自動的にKindleへの送信まで行うようになり、究極のものぐさ環境が完成します。\r\nスクリプトの最後のほうの\r\n`\t\t\t\t\t-- send\t-- eliminate '--' if you like to send mail automatically\r\n`\r\nというところ、「send」の前の「--」を消すと、メール作成後勝手に送るようになります。\r\n\r\n`\t\t\t\t\tsend\t-- eliminate '--' if you like to send mail automatically\r\n`\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}